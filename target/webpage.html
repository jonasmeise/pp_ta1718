<html>
<link rel="stylesheet" href="styles.css">
<head>
<title>Review Analysis Tool</title>

</head>


<script language="javascript" type="text/javascript">
	window.setInterval("update();", 1000);
	var toggled=true;
	
	function start() {
		var pathname = window.location.pathname;
		var res = pathname.substr(1, pathname.lastIndexOf('/'));
		console.log("cd> " + res);
		RunEXE(res);
	}

    function RunEXE(path) {
        var oShell = new ActiveXObject("WScript.Shell");	
	//Argumente prüfen
	var jarName = "de.unidue.langtech.teaching.pp.meise-0.0.1-SNAPSHOT-standalone.jar";

	
	var localFile = document.getElementById('r1').checked;
	var amazon = document.getElementById('r2').checked;
	var url = document.getElementsByName('url')[0].value;
	var filterASIN = document.getElementsByName('filterASIN')[0].value;
	var maxCut = document.getElementsByName('maxCut')[0].value;
	var consoleLog = document.getElementById('console').value;
	var consoleParameter = 1;
	
	var e = document.getElementById("sort");
	var wert = e.options[e.selectedIndex].value;
	var parameterSort = "quantity";
	if(!consoleLog) {
		consoleParametrer = 0;
	}
	if(wert==1) { parameter = "emotion"; }
		
	if(url!="") {
		if(localFile) {
		        oShell.Run('cmd /c cd ' + path + ' && java -jar ' + jarName + ' file,' + filterASIN + ' "' + url + '" ' + maxCut + " " + parameterSort, consoleParameter);
		}
		else if(amazon) {
			console.log('cmd /c cd ' + path + ' && java -jar ' + jarName + ' amazonURL "' + url + '" ' + maxCut);
			oShell.Run('cmd /c cd ' + path + ' && java -jar ' + jarName + ' amazonURL "' + url + '" ' + maxCut + " " + parameterSort, consoleParameter);
		}
	}
    }

	function update() {
		if(toggled) {
	    		document.getElementById("iframeA").src = document.getElementById("iframeA").src;
		}
	}

	function toggle(boo) {
		toggled = boo;
	}
</script>

<body>

<form>
<fieldset>
<legend>Input Settings</legend>
  <input type="radio" id="r1" name="type" value="file">Local .json Database<br>
  <input type="radio" id="r2" name="type" value="amazon" checked>Amazon URL<br><br>

  URL to file/Amazon<br>
  <input type="url" name="url"><br>
  ASIN filter (only relevant for .json database)<br>
  <input type="text" name="filterASIN" maxlength="10"><br>

   Data Cutoff<br>
  <input type="number" name="maxCut"
   min="0" max="500" step="10" value="150"><br>
   Sort By<br> 
   <select id="sort">
	
   <option>Emotional Rating</option>
   <option>Keyword Quantity</option>
   </select><br>
   

   <input type="checkbox" id="console" checked>
   <label for="console">Show Console Log</label><br>
  <button onclick="start()">Start Analysis</button>


</fieldset>
</form>

<iframe onmouseenter="toggle(false)" onmouseleave="toggle(true)" src="output.html" name="targetframe" id="iframeA" allowTransparency="true" scrolling="yes" frameborder="0" >
</iframe>

</html>